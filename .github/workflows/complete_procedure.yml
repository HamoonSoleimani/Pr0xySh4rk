# ----------------------------------------------------------------
      # STEP 2: SETUP TOOLS (Xray-Knife & GeoIP)
      # ----------------------------------------------------------------
      - name: Install Tools
        run: |
          # 1. Download GeoIP DB
          echo "Downloading GeoIP Database..."
          wget -q -O Country.mmdb "${{ env.GEOIP_URL }}"

          # 2. Download Xray-Knife (Fixed)
          echo "Fetching latest xray-knife..."
          LATEST_TAG=$(curl -sL "https://api.github.com/repos/lilendian0x00/xray-knife/releases/latest" | jq -r ".tag_name")
          DOWNLOAD_URL="https://github.com/lilendian0x00/xray-knife/releases/download/${LATEST_TAG}/Xray-knife-linux-64.zip"
          
          # Download to temp file
          wget -q -O xray-temp.zip "$DOWNLOAD_URL"
          
          # Unzip into specific directory to avoid conflicts
          unzip -o xray-temp.zip -d xray_bin
          
          # Move binary out and cleanup
          mv xray_bin/xray-knife .
          rm -rf xray_bin xray-temp.zip
          
          chmod +x xray-knife
          
          # Quick verification command to ensure it's runnable
          ./xray-knife --help > /dev/null && echo "xray-knife installed and runnable"
